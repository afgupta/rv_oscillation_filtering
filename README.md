# rv_oscillation_filtering
Code for predicting residual amplitudes for RV observations of p-mode oscillations. 

Predict the exposure time required to reach a specific residual amplitude using the `residual_osc_amplitude.py` script.

Single star example (calculate exposure time to reach 9 cm/s for a Solar analog):

`python -m residual_osc_amplitude Sun 0.09`

Multiple star example (calculate and save exposure time to reach 10 cm/s for all stars in the input file `star_inputs.csv`):

`python -m residual_osc_amplitude ALL 0.1 --filename=star_inputs.csv -s`

Stellar parameter inputs can be stored in the `/inputs/` directory. All saved outputs will be placed in `/outputs/`. A zoomed in plot of the residual amplitude curve near the point of interest is generated by default when running this on a single star.

Optional flags: 

* `-p, --plot`: toggle plot residual amplitude curve
* `-s, --save`: save outputs when running for a list of stars
* `-f, --filename`: specify the stellar parameter input file
* `-v, --verbose`: toggle verbose output

The modules upon which the script relies can also be accessed independently, as shown in the examples given in `example_plots.py`.

# Residual amplitude calculation

By default, the residual amplitude calculation adheres to the equations given in [Chaplin et al. (2019)](https://ui.adsabs.harvard.edu/abs/2019AJ....157..163C/abstract). However, we do provide some alternate options.

### Sequences of exposures separated by a non-zero readout time

Observations of bright stars with EPRV spectrographs will often be split into multiple exposures to avoid saturating the detector. We include an option to specify a sequence of exposures rather than a single exposure when calculating the residual amplitude. In this case, the transfer function is replaced by that derived by [Gupta et al. (2022)](https://ui.adsabs.harvard.edu/abs/2022AJ....164..254G/abstract).

### Discrete oscillation modes

The user can also choose to calculate the residual oscillation amplitude from a comb of discrete oscillation modes rather than an oscillation power excess by setting `method=comb` in the `residual_amplitude()` function. This produces results very similar to those of the Chaplin method, but it is not perfectly accurate and it does rely on some simplified assumptions (e.g., small frequency spacing).

This functionality is not currently available via the command line.
